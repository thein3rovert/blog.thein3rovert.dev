---
import { type CollectionEntry, getCollection } from "astro:content";
import SocialList from "@/components/SocialList.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
// import Note from "@/components/note/Note.astro";
import { getAllPosts } from "@/data/post";
import PageLayout from "@/layouts/Base.astro";
import { collectionDateSort } from "@/utils/date";

// Posts
const MAX_POSTS = 10; // Changing the noof post in the frontend
const allPosts = await getAllPosts();
const allPostsByDate = allPosts
	.sort(collectionDateSort)
	.slice(0, MAX_POSTS) as CollectionEntry<"post">[];

// Notes
const MAX_NOTES = 5;
const allNotes = await getCollection("note");
const latestNotes = allNotes.sort(collectionDateSort).slice(0, MAX_NOTES);
---

<PageLayout meta={{ title: "Home" }}>
  <!-- Introduction Section -->
  <section class="px-1 sm:p-4 mb-8">
		<h2 class="title mb-6">HI, I'M SAMAD.</h2>
		<p class="mb-4 text-base">
			Coder, cyclist, hiker, mini-PC enthusiast, soon-to-be long-haul homelaber, GNU/Linux guy, and
			mid-tier keyboard snob. I use Nix, btw.
		</p>
		<SocialList />
		<hr class="">
		<h2 class="title mb-6 pt-6">CONTACT</h2>
		<p class="text-base">
    <!-- Add glance homepage when ready -->
		<!-- <a href="https://linkding.thein3rovert.dev">thein3rovert.dev</a> -->
		<a href="mailto:danielolaibi@gmail.com">thein3rovert@gmail.com</a>
		</p>
	</section>

  <!--Post section -->
	<section class="mt-4 px-1 sm:p-4" aria-label="Blog Posts">
    <h2 class="title text-accent mb-4 text-xl text-center">
      <a href="/terminal/">recent</a>
    </h2>
    <ul class=" text-white-500 font-mono space-y-1 text-base" role="list">
      {
      allPostsByDate.map((p) => (
      <li class="flex items-start">
      <span class="pr-2 select-none">$</span>
      <PostPreview post={p} />
      </li>
      ))
      }
    </ul>
	</section>
	{
	// I dont want to have the note in the homepage
		latestNotes.length > 0 && (
			<!-- <section class="mt-16">
				<h2 class="title text-accent mb-6 text-xl">
					<a href="/notes/">Notes</a>
				</h2>
        <ul class="bg-black text-green-500 font-mono p-4 rounded-lg shadow-lg space-y-2" role="list" style="border: 2px solid #222;">
          {latestNotes.map((note, idx) => (
            <li class="flex items-start">
              <span class="pr-2 select-none">$ {idx + 1}</span>
              <Note note={note} as="h3" isPreview />
            </li>
          ))}
        </ul>
			</section> -->
		)
	}
</PageLayout>
