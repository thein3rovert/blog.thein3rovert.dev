---
import ThemeToggle from "@/components/ThemeToggle.astro";
import { menuLinks, siteConfig } from "@/site.config";

const url = new URL(Astro.request.url);
const currentPath = url.pathname;

// Function to format date in stat format (YYYY-MM-DD HH:MM:SS -0600)
function formatStatDate(date: Date): string {
	const year = date.getFullYear();
	const month = (date.getMonth() + 1).toString().padStart(2, "0");
	const day = date.getDate().toString().padStart(2, "0");
	const hours = date.getHours().toString().padStart(2, "0");
	const minutes = date.getMinutes().toString().padStart(2, "0");
	const seconds = date.getSeconds().toString().padStart(2, "0");
	return `${year}-${month}-${day} ${hours}:${minutes}:${seconds} -0600`;
}

const currentDate = new Date();
const currentStatDate = formatStatDate(currentDate);
const birthDate = formatStatDate(new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)); // 30 days ago

// Determine current file path based on route
let filePath = "/home/thein3rovert";
let fileSize = "16488 words";

if (currentPath === "/") {
	filePath = "/home/thein3rovert";
	fileSize = "16488 words";
} else if (currentPath.startsWith("/posts/")) {
	filePath = "/home/thein3rovert/posts";
	fileSize = "12000 words";
} else if (currentPath.startsWith("/about")) {
	filePath = "/home/thein3rovert/about";
	fileSize = "800 words";
} else if (currentPath.startsWith("/notes")) {
	filePath = "/home/thein3rovert/notes";
	fileSize = "3500 words";
} else if (currentPath.startsWith("/code")) {
	filePath = "/home/thein3rovert/code";
	fileSize = "2000 words";
} else if (currentPath.startsWith("/terminal")) {
	filePath = "/home/thein3rovert/posts";
	fileSize = "12000 words";
} else {
	filePath = "/home/thein3rovert/posts";
	fileSize = "16488 words";
}
---

<header
	class="bg-global-bg mb-8 w-full border-b border-gray-600 font-mono text-xs"
	id="main-header"
>
	<div class="mx-auto max-w-6xl px-4 py-2 sm:px-8">
		<!-- Terminal file header -->
		<div class="mb-2 space-y-0 leading-tight">
			<div class="hover:text-accent cursor-pointer">
				<a href="/" class="hover:underline">
					File: {filePath}
				</a>
			</div>
			<div class="text-gray-400">Size: {fileSize}</div>
			<div class="text-gray-400">
				Access: (0644/-rw-r--r--) Uid: ( 1000/thein3rovert) Gid: ( 100/ users)
			</div>
			<div class="text-gray-400">Modify: {currentStatDate}</div>
			<div class="text-gray-400">Birth: {birthDate}</div>
		</div>

		<!-- Terminal navigation -->
		<div class="flex flex-wrap items-center gap-2">
			<span class="text-gray-400">Pages:</span>
			{
				menuLinks.map((link, index) => (
					<span>
						<a
							href={link.path}
							class={`hover:underline ${
								currentPath === link.path ||
								(link.path !== "/" && currentPath.startsWith(link.path))
									? "text-accent font-bold"
									: "text-accent"
							}`}
							data-astro-prefetch
						>
							{link.title}
						</a>
						{index < menuLinks.length - 1 && <span class="ml-1 text-gray-400">|</span>}
					</span>
				))
			}
			<div class="ml-auto">
				<ThemeToggle />
			</div>
		</div>
	</div>
</header>

<style>
	.font-mono {
		font-family: "Courier New", Courier, monospace;
		letter-spacing: 0;
	}

	a {
		color: inherit;
		text-decoration: none;
	}

	a:hover {
		text-decoration: underline;
	}

	/* Terminal header styling - full width at top */
	header {
		backdrop-filter: blur(8px);
		border-bottom: 2px solid #4a5568;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
	}

	/* Dark mode adjustments */
	:global(.dark) header {
		border-bottom-color: #718096;
		background: rgba(0, 0, 0, 0.8);
	}

	:global(.light) header {
		background: rgba(255, 255, 255, 0.9);
	}
</style>
